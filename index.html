<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Nexus Churchs — WOW Display</title>

<link rel="stylesheet" href="styles.css">

<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>

<!-- jsPDF -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>

<body>

<header class="topbar">
  <div class="brand">
    <div class="logo">NC</div>
    <div>
      <div class="brandTitle">Nexus Churchs</div>
      <div class="brandSub" id="modeLabel">Modo</div>
    </div>
  </div>

  <div class="topActions">
    <div class="chip" id="churchChip">
      <span class="chipLabel">Iglesia</span>
      <select id="churchSelect" title="Selecciona la iglesia"></select>
    </div>

    <button id="btnSettings" class="ghost" type="button" title="Configuración">⚙️</button>

    <div class="kpiBox">
      Total Sesión
      <b id="totalCount">0</b>
    </div>
  </div>
</header>

<div class="grid">

  <!-- PANEL IZQUIERDO: OPERACIÓN (LIMPIO) -->
  <section class="card">

    <!-- STATUS SESIÓN (visible en staff/admin; oculto en kiosk) -->
    <div id="opsBlock">
      <h2>Sesión</h2>
      <div class="sessionBar">
        <div id="sessionPill" class="pill bad">CERRADA</div>
        <button id="btnOpenSession" type="button">Abrir</button>
        <button id="btnCloseSession" type="button" class="ghost" disabled>Cerrar</button>
      </div>
      <input id="sessionTitle" placeholder="Nombre sesión (ej: Domingo 10AM)" />
      <div class="hint" id="sessionMeta">—</div>

      <hr class="sep">
    </div>

    <!-- REGISTRO RÁPIDO (SIEMPRE) -->
    <h2>Registro Rápido</h2>

    <form id="checkinForm" autocomplete="off">
      <input id="fullName" placeholder="Nombre y Apellido" required>
      <div id="nameError" class="error" hidden>Nombre + apellido requerido</div>

      <div class="quickBtns">
        <button type="button" class="q" data-n="1">1</button>
        <button type="button" class="q" data-n="2">2</button>
        <button type="button" class="q" data-n="3">3</button>
        <button type="button" class="q" data-n="4">4</button>
        <button type="button" class="q" data-n="5">5</button>
      </div>

      <input id="partySize" type="number" value="1" min="1">
      <button id="btnCheckin">Registrar</button>
    </form>

    <!-- HISTORIAL (visible en staff/admin; oculto en kiosk) -->
    <div id="historyBlock">
      <hr class="sep">
      <h2>Historial</h2>
      <div class="hint">PDF por sesión.</div>
      <div id="historyList" class="history"></div>
    </div>

  </section>

  <!-- DISPLAY WOW -->
  <section class="card display wow" id="displayCard">
    <button id="btnFullscreen" class="ghost fsBtn" type="button">⛶</button>

    <div class="welcomeWrap">
      <div id="welcomeBig" class="welcomeBig">Bienvenidos</div>
    </div>

    <div class="ticker">
      <div id="tickerTrack" class="tickerTrack"></div>
    </div>
  </section>

</div>

<!-- PANEL CONFIG (solo staff/admin; admin ve crear iglesia) -->
<div id="settingsPanel" class="drawer" hidden>
  <div class="drawerHead">
    <div>
      <div class="drawerTitle">Configuración</div>
      <div class="drawerSub" id="settingsSub">Staff/Admin</div>
    </div>
    <button id="btnCloseSettings" class="ghost" type="button">Cerrar</button>
  </div>

  <div class="drawerBody">

    <!-- ADMIN: Crear iglesias -->
    <div id="adminBlock">
      <h3>Iglesias</h3>
      <div class="row2">
        <div>
          <div class="hint">Nombre nueva iglesia</div>
          <input id="newChurchName" placeholder="Ej: Iglesia Casa de Bendición">
        </div>
        <div>
          <div class="hint">Crear</div>
          <button id="btnCreateChurch" type="button">+ Nueva</button>
        </div>
      </div>
      <div class="hint" id="createMsg">Crea una iglesia y genera link.</div>
      <hr class="sep">
    </div>

    <h3>WOW</h3>
    <div class="row2">
      <div>
        <div class="hint">Duración saludo (seg)</div>
        <input id="wowSeconds" type="number" min="1" max="30" value="6">
      </div>
      <div>
        <div class="hint">Aplicar</div>
        <button id="btnApplyWow" type="button" class="ghost">Actualizar</button>
      </div>
    </div>

    <h3>Link</h3>
    <button id="btnCopyLink" class="ghost" type="button">Copiar Link</button>

    <div class="hint">Tip: usa <b>mode=kiosk</b> para tablets públicas.</div>
  </div>
</div>

<script src="app.js"></script>
</body>
</html>
